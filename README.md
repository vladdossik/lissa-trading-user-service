# Lissa Trading User Service

**User Service** предоставляет функционал для управления пользователями, регистрацией, авторизацией, а также доступ к
данным пользователей и их статистике. Сервис взаимодействует с внешними API и внутренними системами через события и REST
API.

## Разработка на проекте

- Ветки называем по идентификатору задачи: `feat(USER-1)` или `bugfix(USER-1)`
- Креды от серверов, баз данных и других ресурсов не прописываем в коде, используем переменные окружения
- Все фичи проверяются локально, покрываются тестами (unit и integration), затем проверяются на сервере, и только после
  этого переводятся в done
- Комментарии к задаче пишем на английском языке с чётким описанием выполненной работы
- Одна ветка — одна задача. Несколько задач в одной ветке не допускаются
- Все сервисы используют одну базу данных с разными схемами
- Схема базы должна называться по имени сервиса, например: `user_service_db`

### Основные функции:

1. **Управление пользователями**:

- Создание, обновление и удаление пользователей
- Поиск пользователей по различным параметрам
- Регистрация временных пользователей

2. **Авторизация**:

- Поддержка JWT токенов для авторизации пользователей
- Внутренние токены для взаимодействия между сервисами

3. **Работа со статистикой**:

- Получение ежедневной статистики пользователей
- Управление и хранение данных статистики

### Архитектура:

#### Контроллеры:

- **UserController**: Управляет CRUD операциями пользователей, включая регистрацию и получение данных о пользователях
- **UserRegController**: Обрабатывает регистрацию пользователей
- **InternalController**: Внутренние запросы между сервисами

#### Сервисы:

- **UserService**: Управляет бизнес-логикой, связанной с пользователями
- **TempUserRegService**: Обрабатывает временную регистрацию пользователей
- **UserStatService**: Управляет данными статистики пользователей

#### DTO (Data Transfer Object):

- **patch**: DTO для обработки частичных обновлений данных пользователей
- **post**: DTO для отправки данных при создании новых пользователей
- **response**: DTO для формирования ответа на запросы

#### События:

- **TempUserSavedEvent**: Событие, генерируемое при сохранении временного пользователя

#### Мапперы:

- **UserMapper**: Преобразование данных пользователей из сущностей в DTO и обратно
- **TempUserRegMapper**: Преобразование данных временной регистрации

#### Репозитории:

- **UserRepository**: Работа с базой данных пользователей
- **TempUserRegRepository**: Репозиторий для временных регистраций пользователей

### Безопасность:

Конфигурация безопасности основана на проверке JWT токенов для авторизации, а также на внутренних системных токенах для
безопасного взаимодействия между сервисами.

---

## Kubernetes Deployment

Для развёртывания сервиса в Kubernetes предусмотрены следующие конфигурационные файлы:
`deployment.yaml`, `service.yaml`.
